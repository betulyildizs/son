çok karışık bir kod olduğu için içime sinmedi. kod temiz olarak tekrar yazılacak.
